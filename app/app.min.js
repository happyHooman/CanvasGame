class Sprite{constructor(t){this.options=t,this.context=t.context,this.tick=0,this.frameIndex=0,this.positionX=0,this.positionY=0,this.image=new Image,this.image.src=this.options.imageSrc,this.direction=this.options.animations.down,this.isMoving=!1,this.stepLength=5,console.log(this.options.ticksPerFrame)}render(){let t=this;t.options.context.clearRect(t.positionX-t.stepLength,t.positionY-t.stepLength,t.options.width+2*t.stepLength,t.options.height+2*t.stepLength),t.options.context.drawImage(t.image,t.frameIndex*t.options.width,t.direction*t.options.height,t.options.width,t.options.height,t.positionX,t.positionY,t.options.width,t.options.height)}update(){let t=this;if(t.tick++,t.tick>t.options.ticksPerFrame){switch(t.tick=0,t.frameIndex=t.frameIndex<t.options.numberOfFrames-1?t.frameIndex+1:0,!0){case t.direction===t.options.animations.down:t.positionY+=t.stepLength;break;case t.direction===t.options.animations.up:t.positionY-=t.stepLength;break;case t.direction===t.options.animations.left:t.positionX-=t.stepLength;break;case t.direction===t.options.animations.right:t.positionX+=t.stepLength}t.render()}t.isMoving?window.requestAnimationFrame(function(){t.update()}):window.requestAnimationFrame(function(){t.tick=0,t.frameIndex=0,t.render()})}move(t){this.isMoving=!0,this.frameIndex=0,this.direction=this.options.animations[t],console.log("moving",t),this.update()}stopMoving(){let t=this;t.isMoving=!1,t.frameIndex=0,window.requestAnimationFrame(function(){t.update()})}}class Player{constructor(t){this.name=t,this.canvas=document.getElementById("playerCanvas"),this.options={context:this.canvas.getContext("2d"),imageSrc:"img/rpg.png",numberOfFrames:4,ticksPerFrame:3,width:34,height:52,animations:{down:0,left:1,right:2,up:3}},this.sprite=new Sprite(this.options),this.sprite.render()}initialize(){document.onkeydown=function(t){this.move(t)},document.onkeyup=function(){this.stopMoving()}}move(t){if(t.preventDefault(),!t.repeat)switch(t.keyCode){case 37:this.sprite.move("left");break;case 38:this.sprite.move("up");break;case 39:this.sprite.move("right");break;case 40:this.sprite.move("down")}}stopMoving(){this.sprite.stopMoving()}}const playerCanvas=document.getElementById("playerCanvas");playerCanvas.width=600,playerCanvas.height=600;let player=new Player("Valentin");window.addEventListener("load",function(){player.sprite.render()}),document.onkeydown=function(t){player.move(t)},document.onkeyup=function(){player.stopMoving()};